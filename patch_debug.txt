*** Begin Patch
*** Update File: src/sddai_bridge.cpp
@@
-#include "sddai_bridge.h"
-
-#include "Bridge.h"
-#include "preview_window.h"
-
-#include <QDir>
-#include <QFile>
-#include <QFileInfo>
-#include <QJsonArray>
-#include <QJsonDocument>
-#include <QJsonObject>
+#include "sddai_bridge.h"
+
+#include "Bridge.h"
+#include "preview_window.h"
+
+#include <QDesktopServices>
+#include <QDir>
+#include <QFile>
+#include <QFileInfo>
+#include <QJsonArray>
+#include <QJsonDocument>
+#include <QJsonObject>
+#include <QUrl>
@@
-SddaiBridge::SddaiBridge(Bridge* core, QObject* parent)
-    : QObject(parent), core_(core) {}
-
-void SddaiBridge::setProjectRoot(const QString& projectRoot) { projectRoot_ = projectRoot; }
+SddaiBridge::SddaiBridge(Bridge* core, QObject* parent)
+    : QObject(parent), core_(core) {}
+
+void SddaiBridge::setProjectRoot(const QString& projectRoot) { projectRoot_ = QDir(projectRoot).absolutePath(); }
+
+static Qt::CaseSensitivity sddaiPathCaseSensitivity() {
+#ifdef Q_OS_WIN
+  return Qt::CaseInsensitive;
+#else
+  return Qt::CaseSensitive;
+#endif
+}
 
 QString SddaiBridge::resolveSafePath(const QString& relativePath) const {
-  const QString root = QDir(projectRoot_).absolutePath();
-  const QString rel = QDir::cleanPath(relativePath);
-
-  if (QDir::isAbsolutePath(rel) || rel.contains(":")) return QString();
-
-  const QString abs = QDir(root).absoluteFilePath(rel);
-  QFileInfo absInfo(abs);
-  QFileInfo rootInfo(root);
-
-  const QString absCanon = absInfo.exists() ? absInfo.canonicalFilePath() : QFileInfo(abs).absoluteFilePath();
-  const QString rootCanon = rootInfo.exists() ? rootInfo.canonicalFilePath() : rootInfo.absoluteFilePath();
-
-  if (!absCanon.startsWith(rootCanon)) return QString();
-  return absCanon;
+  const QString rootAbs = QDir(projectRoot_).absolutePath();
+  if (rootAbs.isEmpty()) return QString();
+
+  QString cleaned = QDir::cleanPath(relativePath.trimmed());
+  if (cleaned.isEmpty()) return QString();
+
+  if (cleaned.startsWith("qrc:", sddaiPathCaseSensitivity()) ||
+      cleaned.startsWith(":", sddaiPathCaseSensitivity()) ||
+      cleaned.startsWith("http:", sddaiPathCaseSensitivity()) ||
+      cleaned.startsWith("https:", sddaiPathCaseSensitivity())) {
+    return QString();
+  }
+
+  const QString candidateAbs = QDir::isAbsolutePath(cleaned)
+      ? QFileInfo(cleaned).absoluteFilePath()
+      : QFileInfo(QDir(rootAbs).filePath(cleaned)).absoluteFilePath();
+
+  const QString rel = QDir(rootAbs).relativeFilePath(candidateAbs);
+  if (rel.startsWith("..", sddaiPathCaseSensitivity()) || QDir::isAbsolutePath(rel))
+    return QString();
+
+  return candidateAbs;
 }
@@
   if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) return QString();
 
   const qint64 MAX_BYTES = 2LL * 1024 * 1024;
   QByteArray data = f.read(MAX_BYTES + 1);
   if (data.size() > MAX_BYTES) data = data.left(MAX_BYTES);
 
   return QString::fromUtf8(data);
 }
+
+static bool sddaiIsMarkdown(const QString& absPath) {
+  const QString lower = absPath.toLower();
+  return lower.endsWith(".md") || lower.endsWith(".markdown") || lower.endsWith(".mdown");
+}
@@
 void SddaiBridge::openPath(const QString& relativePath) {
   const QString absPath = resolveSafePath(relativePath);
   if (absPath.isEmpty()) return;
 
-  if (!preview_) {
-    preview_ = new PreviewWindow();
-    preview_->setAttribute(Qt::WA_DeleteOnClose, false);
-  }
-
-  const QString text = readTextFile(relativePath);
-  preview_->loadFile(relativePath, text);
-  preview_->show();
-  preview_->raise();
-  preview_->activateWindow();
+  if (sddaiIsMarkdown(absPath)) {
+    QFile f(absPath);
+    if (!f.open(QIODevice::ReadOnly | QIODevice::Text)) return;
+    const QString text = QString::fromUtf8(f.readAll());
+
+    if (!preview_) {
+      preview_ = new PreviewWindow(qobject_cast<QWidget*>(parent()));
+      preview_->setAttribute(Qt::WA_DeleteOnClose, false);
+    }
+
+    preview_->loadFile(absPath, text);
+    preview_->show();
+    preview_->raise();
+    preview_->activateWindow();
+    return;
+  }
+
+  QDesktopServices::openUrl(QUrl::fromLocalFile(absPath));
 }
*** End Patch
